<!DOCTYPE html>

<head>
  <meta charset="utf-8">
  <title>KMS(PPARTYID)</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1" />
  <!-- <link rel="shortcut icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon"> -->
  <link href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.staticfile.org/jquery/2.0.0/jquery.min.js"></script>
  <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>

<body>
  <h1 align="center">CG Multi-Party ECDSA (Party PARTYID)</h1>
  <hr />

  <!-- connect -->
  <div style="padding-left: 2.5%;padding-right: 2.5%;">
    <form class="form-horizontal" id="form-connect" role="form" onsubmit="return false;">
      <!-- todo -->
      <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
          <button type="submit" class="btn btn-default" value="connect" name="connect" id="btn-connect">connect</button>
        </div>
      </div>
    </form>
    <form class="form-horizontal" id="form-signconnect" role="form" onsubmit="return false;">
      <!-- todo -->
      <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
          <button type="submit" class="btn btn-default" value="signconnect" name="signconnect"
            id="btn-signconnect">signconnect</button>
        </div>
      </div>
    </form>
  </div>

  <hr />

  <!-- keygen-init -->
  <div style="padding-left: 2.5%;padding-right: 2.5%;">
    <form class="form-horizontal" id="form-keygen-init" role="form" onsubmit="return false;">
      <!-- todo -->
      <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
          <button type="submit" class="btn btn-default" value="keygen-init" name="keygen-init"
            id="btn-keygen-init">keygen-init</button>
        </div>
      </div>
    </form>
  </div>
  <!-- keygen -->
  <div style="padding-left: 2.5%;padding-right: 2.5%;">
    <form class="form-horizontal" id="form-keygen" role="form" onsubmit="return false;">
      <!-- todo -->
      <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
          <button type="submit" class="btn btn-default" value="keygen" name="keygen" id="btn-keygen"
            DISABLED>keygen</button>
        </div>
      </div>
    </form>
  </div>

  <hr />

  <!-- sign-init -->
  <div style="padding-left: 2.5%;padding-right: 2.5%;">
    <form class="form-horizontal" id="form-sign-init" role="form" onsubmit="return false;">
      <!-- todo -->
      <div class="form-group">
        <label for="msg" class="col-xs-2 control-label">msg</label>
        <div class="col-xs-4">
          <input type="text" class="form-control" name="msg" id="msg"
            value="eadffe25ea1e8127c2b9aae457d8fdde1040fbbb62e11c281f348f2375dd3f1d" DISABLED>
        </div>
      </div>
      <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
          <button type="submit" class="btn btn-default" value="sign-init" name="sign-init"
            id="btn-sign-init">sign-init</button>
        </div>
      </div>
    </form>
  </div>
  <!-- sign -->
  <div style="padding-left: 2.5%;padding-right: 2.5%;">
    <form class="form-horizontal" id="form-sign" role="form" onsubmit="return false;">
      <!-- todo -->
      <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
          <button type="submit" class="btn btn-default" value="sign" name="sign" id="btn-sign" DISABLED>sign</button>
        </div>
      </div>
    </form>
  </div>

  <hr />

  <!-- disconnect -->
  <div style="padding-left: 2.5%;padding-right: 2.5%;">
    <form class="form-horizontal" id="form-disconnect" role="form" onsubmit="return false;">
      <!-- todo -->
      <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
          <button type="submit" class="btn btn-default" value="disconnect" name="disconnect"
            id="btn-disconnect">disconnect</button>
        </div>
      </div>
    </form>
  </div>

  <hr />


  <div class="col-sm-offset-2 col-sm-8">
    Response:<br />
    <textarea id="text-resp" rows="4" cols="100%" readonly></textarea>
  </div>
  <div class="col-sm-offset-2 col-sm-8">
    Key:<br />
    <textarea id="text-keygen-resp" rows="4" cols="100%" readonly></textarea>
  </div>
  <div class="col-sm-offset-2 col-sm-8">
    Signature:<br />
    <textarea id="text-sign-resp" rows="4" cols="100%" readonly></textarea>
  </div>


  <script type="text/javascript">
    $(document).ready(function () {
      // $("#init").click(function () {
      //   $("#lll").text("dd");
      // });

      $("#form-init").submit(function () {
        var postData = $("#form-init").serialize();
        console.log(postData);
        $.ajax({
          type: "POST",
          url: "/init",
          data: postData,
          beforeSend: function () {
            $("#btn-init").attr("disabled", true);
            $("#text-resp").text("please wait ...");
          },
          success: function (msg) {
            $("#btn-init").attr("disabled", false);
            $("#text-resp").text(msg);
          }
        });
      });


      $("#form-connect").submit(function () {
        var postData = $("#form-connect").serialize();
        console.log(postData);
        $.ajax({
          type: "POST",
          url: "/connect",
          data: postData,
          beforeSend: function () {
            $("#btn-connect").attr("disabled", true);
            $("#text-resp").text("please wait ...");
          },
          success: function (msg) {
            $("#btn-connect").attr("disabled", false);
            $("#text-resp").text(msg);
          }
        });
      });
      $("#form-signconnect").submit(function () {
        var postData = $("#form-signconnect").serialize();
        console.log(postData);
        $.ajax({
          type: "POST",
          url: "/signconnect",
          data: postData,
          beforeSend: function () {
            $("#btn-signconnect").attr("disabled", true);
            $("#text-resp").text("please wait ...");
          },
          success: function (msg) {
            $("#btn-signconnect").attr("disabled", false);
            $("#text-resp").text(msg);
          }
        });
      });

      $("#form-disconnect").submit(function () {
        var postData = $("#form-disconnect").serialize();
        console.log(postData);
        $.ajax({
          type: "POST",
          url: "/disconnect",
          data: postData,
          beforeSend: function () {
            $("#btn-disconnect").attr("disabled", true);
            $("#text-resp").text("please wait ...");
          },
          success: function (msg) {
            $("#btn-disconnect").attr("disabled", false);
            $("#text-resp").text(msg);
          }
        });
      });

      $("#form-keygen").submit(function () {
        var postData = $("#form-keygen").serialize();
        console.log(postData);
        $.ajax({
          type: "POST",
          url: "/keygen",
          data: postData,
          beforeSend: function () {
            $("#btn-keygen").attr("disabled", true);
            $("#text-resp").text("please wait ...");
          },
          success: function (msg) {
            $("#btn-keygen").attr("disabled", false);
            $("#text-resp").text(msg);
          }
        });
      });

      $("#form-sign").submit(function () {
        var postData = $("#form-sign").serialize();
        console.log(postData);
        $.ajax({
          type: "POST",
          url: "/sign",
          data: postData,
          beforeSend: function () {
            $("#btn-sign").attr("disabled", true);
            $("#text-resp").text("please wait ...");
          },
          success: function (msg) {
            $("#btn-sign").attr("disabled", false);
            $("#text-resp").text(msg);
          }
        });
      });

      $("#form-keygen-init").submit(function () {
        var postData = $("#form-keygen-init").serialize();
        console.log(postData);
        $.ajax({
          type: "POST",
          url: "/keygeninit",
          data: postData,
          beforeSend: function () {
            $("#btn-keygen-init").attr("disabled", true);
            $("#text-resp").text("please wait ...");
          },
          success: function (msg) {
            $("#btn-keygen-init").attr("disabled", false);
            $("#text-resp").text(msg);
          }
        });
      });

      $("#form-sign-init").submit(function () {
        var postData = $("#form-sign-init").serialize();
        console.log(postData);
        $.ajax({
          type: "POST",
          url: "/signinit",
          data: postData,
          beforeSend: function () {
            $("#btn-sign-init").attr("disabled", true);
            $("#text-resp").text("please wait ...");
          },
          success: function (msg) {
            $("#btn-sign-init").attr("disabled", false);
            $("#text-resp").text(msg);
          }
        });
      });



      var timer1;
      var timer2;
      var count1 = 1
      var count2 = 1
      function getKeyGenResult() {
        //clearInterval(timer1);
        //$('#text-keygen-resp').text(count1++);
        //timer1 = setInterval(getKeyGenResult, 2000);
        $.ajax({
          type: "GET",
          url: "/getkey",
          data: "",
          beforeSend: function () {
          },
          success: function (msg) {
            $("#text-keygen-resp").text(msg);
          }
        });
      }

      function getSignResult() {
        $.ajax({
          type: "GET",
          url: "/getsignature",
          data: "",
          beforeSend: function () {
          },
          success: function (msg) {
            $("#text-sign-resp").text(msg);
          }
        });
      }
      timer1 = setInterval(getKeyGenResult, 2000);
      timer2 = setInterval(getSignResult, 2000);

    });

  </script>

</body>

</html>